import{_ as F,a3 as M,a4 as U,J as D,c as r,a as o,b as l,d as t,C as p,e as j,t as g,F as h,A as w,f as z,g as P,E as v,L as J,o as n,M as f,w as W,r as N}from"./index-D4yXbplw.js";import{s as _}from"./index-CubMQrjb.js";import{b as H,a as K}from"./index-B7kpHtsI.js";import{s as Q}from"./index-Dd3LGBax.js";import{a as R}from"./index-Bv36is8d.js";import{s as X}from"./repositorios-sGaJ6pbY.js";import{u as Y}from"./categorias-CBZr8j9o.js";import"./index-DEf-bt_W.js";const Z={class:"page-header"},oo={class:"tab-bar"},ao={class:"tab-count"},eo={class:"tab-count"},so={key:0,class:"loading-center"},io={key:1,class:"cats-grid"},to={class:"cat-info"},lo={class:"cat-nombre"},ro={class:"cat-tipo text-muted"},no={class:"cat-acciones"},co={key:0,class:"empty-tab card"},uo={class:"field"},po={key:0,class:"error"},go={class:"field"},bo={class:"field"},mo={class:"color-picker-row"},vo=["onClick"],fo={class:"field"},_o={class:"iconos-grid"},yo=["onClick"],Co={class:"preview-row"},ko={style:{"font-size":"0.9rem","font-weight":"600"}},$o={class:"dialog-footer"},ho={__name:"CategoriasView",setup(wo){const c=Y(),O=M(),y=U(),d=v("gasto"),b=v(!1),m=v(!1),C=v(!1),k=v(null),S=[{label:"üí∏ Gasto",value:"gasto"},{label:"üí∞ Ingreso",value:"ingreso"}],E=["#f59e0b","#ef4444","#10b981","#6366f1","#3b82f6","#8b5cf6","#f97316","#06b6d4","#84cc16","#64748b"],A=["pi-shopping-cart","pi-car","pi-heart","pi-bolt","pi-book","pi-shopping-bag","pi-home","pi-star","pi-wallet","pi-briefcase","pi-music","pi-phone","pi-gift","pi-airplane","pi-graduation-cap","pi-tag","pi-plus-circle","pi-building","pi-money-bill","pi-chart-bar"],V=()=>({nombre:"",tipo_transaccion:"gasto",color:"#6366f1",icono:"pi-tag"}),s=N(V()),u=N({}),x=J(()=>c.categorias.filter(i=>i.activa!==!1&&i.tipo_transaccion===d.value));D(()=>c.cargar());function L(){m.value=!1,k.value=null,Object.assign(s,{...V(),tipo_transaccion:d.value}),Object.assign(u,{}),b.value=!0}function G(i){m.value=!0,k.value=i,Object.assign(s,{nombre:i.nombre,tipo_transaccion:i.tipo_transaccion,color:i.color||"#6366f1",icono:i.icono||"pi-tag"}),Object.assign(u,{}),b.value=!0}function I(){return Object.assign(u,{}),s.nombre.trim()||(u.nombre="El nombre es requerido"),Object.keys(u).length===0}async function T(){if(I()){C.value=!0;try{m.value?(await c.actualizar(k.value._id,{...s}),y.add({severity:"success",summary:"Categor√≠a actualizada",life:3e3})):(await c.crear({...s}),y.add({severity:"success",summary:"Categor√≠a creada",life:3e3})),b.value=!1}catch(i){y.add({severity:"error",summary:"Error",detail:i.message,life:5e3})}finally{C.value=!1}}}function q(i){O.require({message:`¬øDesactivar la categor√≠a "${i.nombre}"?`,header:"Confirmar",icon:"pi pi-exclamation-triangle",acceptLabel:"S√≠, desactivar",rejectLabel:"Cancelar",acceptClass:"p-button-danger",accept:async()=>{await c.eliminar(i._id),y.add({severity:"info",summary:"Categor√≠a desactivada",life:3e3})}})}const B=i=>({gasto:"Gasto",ingreso:"Ingreso",ambos:"Ambos"})[i]||i;return(i,a)=>(n(),r("div",null,[o("div",Z,[a[6]||(a[6]=o("div",null,[o("h1",{class:"page-title"},"Categor√≠as"),o("p",{class:"page-subtitle"},"Organiza tus gastos e ingresos por categor√≠a")],-1)),l(t(_),{label:"Nueva categor√≠a",icon:"pi pi-plus",onClick:L})]),o("div",oo,[o("button",{class:p(["tab-btn",{active:d.value==="gasto"}]),onClick:a[0]||(a[0]=e=>d.value="gasto")},[a[7]||(a[7]=o("i",{class:"pi pi-arrow-down-right"},null,-1)),a[8]||(a[8]=j(" Gastos ",-1)),o("span",ao,g(t(c).gastoCats.length),1)],2),o("button",{class:p(["tab-btn",{active:d.value==="ingreso"}]),onClick:a[1]||(a[1]=e=>d.value="ingreso")},[a[9]||(a[9]=o("i",{class:"pi pi-arrow-up-right"},null,-1)),a[10]||(a[10]=j(" Ingresos ",-1)),o("span",eo,g(t(c).ingresoCats.length),1)],2)]),t(c).cargando?(n(),r("div",so,[l(t(X),{strokeWidth:"3"})])):(n(),r("div",io,[(n(!0),r(h,null,w(x.value,e=>(n(),r("div",{key:e._id,class:"cat-card card"},[o("div",{class:"cat-icon",style:f(`background: ${e.color}22; color: ${e.color}`)},[o("i",{class:p(["pi",e.icono])},null,2)],4),o("div",to,[o("span",lo,g(e.nombre),1),o("span",ro,g(B(e.tipo_transaccion)),1)]),o("div",{class:"cat-dot",style:f(`background: ${e.color}`)},null,4),o("div",no,[l(t(_),{icon:"pi pi-pencil",text:"",rounded:"",size:"small",onClick:$=>G(e)},null,8,["onClick"]),l(t(_),{icon:"pi pi-trash",text:"",rounded:"",size:"small",severity:"danger",onClick:$=>q(e)},null,8,["onClick"])])]))),128)),x.value.length===0?(n(),r("div",co,[a[11]||(a[11]=o("i",{class:"pi pi-tag"},null,-1)),o("p",null,"Sin categor√≠as de "+g(d.value==="gasto"?"gasto":"ingreso"),1)])):z("",!0)])),l(t(H),{visible:b.value,"onUpdate:visible":a[5]||(a[5]=e=>b.value=e),header:m.value?"Editar categor√≠a":"Nueva categor√≠a",style:{width:"420px"},modal:"",draggable:!1},{default:P(()=>[o("form",{onSubmit:W(T,["prevent"]),class:"dialog-form"},[o("div",uo,[a[12]||(a[12]=o("label",null,"Nombre *",-1)),l(t(Q),{modelValue:s.nombre,"onUpdate:modelValue":a[2]||(a[2]=e=>s.nombre=e),placeholder:"ej. Alimentaci√≥n, Salario",fluid:""},null,8,["modelValue"]),u.nombre?(n(),r("small",po,g(u.nombre),1)):z("",!0)]),o("div",go,[a[13]||(a[13]=o("label",null,"Tipo *",-1)),l(t(R),{modelValue:s.tipo_transaccion,"onUpdate:modelValue":a[3]||(a[3]=e=>s.tipo_transaccion=e),options:S,optionLabel:"label",optionValue:"value",fluid:""},null,8,["modelValue"])]),o("div",bo,[a[14]||(a[14]=o("label",null,"Color",-1)),o("div",mo,[(n(),r(h,null,w(E,e=>o("div",{key:e,class:p(["color-dot",{selected:s.color===e}]),style:f(`background:${e}`),onClick:$=>s.color=e},null,14,vo)),64))])]),o("div",fo,[a[15]||(a[15]=o("label",null,"√çcono",-1)),o("div",_o,[(n(),r(h,null,w(A,e=>o("div",{key:e,class:p(["icono-btn",{selected:s.icono===e}]),style:f(s.icono===e?`border-color:${s.color};color:${s.color}`:""),onClick:$=>s.icono=e},[o("i",{class:p(["pi",e])},null,2)],14,yo)),64))])]),o("div",Co,[o("div",{class:"cat-icon",style:f(`background: ${s.color}22; color: ${s.color}`)},[o("i",{class:p(["pi",s.icono])},null,2)],4),o("span",ko,g(s.nombre||"Sin nombre"),1)]),o("div",$o,[l(t(_),{label:"Cancelar",severity:"secondary",text:"",onClick:a[4]||(a[4]=e=>b.value=!1)}),l(t(_),{label:m.value?"Guardar cambios":"Crear categor√≠a",icon:"pi pi-check",type:"submit",loading:C.value},null,8,["label","loading"])])],32)]),_:1},8,["visible","header"]),l(t(K))]))}},Ao=F(ho,[["__scopeId","data-v-04cbfd02"]]);export{Ao as default};
